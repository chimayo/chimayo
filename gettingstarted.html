<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Getting started
</title>
    <meta name="description" content="Chimayo is a library for creating and manipulating SQL Server Integration Services packages with F# code."/>
    <meta name="author" content="Chimayo community"/>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <link type="text/css" rel="stylesheet" href="/chimayo/content/style.css" />
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
      <nav class="navbar navbar-inverse navbar-static-top">
          <div class="container">
              <!-- Brand and toggle get grouped for better mobile display -->
              <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1" aria-expanded="false">
                      <span class="sr-only">Toggle navigation</span>
                      <span class="icon-bar"></span>
                      <span class="icon-bar"></span>
                      <span class="icon-bar"></span>
                  </button>
                  <a class="navbar-brand" href="#">Chimayo.Ssis</a>
              </div>
              <div class="collapse navbar-collapse" id="navbar-collapse-1">
                  <ul class="nav navbar-nav">
                      <li><a href="/chimayo/index.html">Home</a></li>
                      <li><a href="/chimayo/license.html">License</a></li>
                      <li class="dropdown">
                          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation<span class="caret"></span></a>
                          <ul class="dropdown-menu">
                              <li><a href="/chimayo/intro.html">Introduction</a></li>
                              <li><a href="/chimayo/gettingstarted.html">Getting started</a></li>
                              <li><a href="/chimayo/features/index.html">Features</a></li>
                              <li><a href="/chimayo/contributing.html">Contributing</a></li>
                              <li><a href="/chimayo/reference/index.html">API Reference</a></li>
                          </ul>
                      </li>
                      <li><a href="/chimayo/reference/index.html">API Reference</a></li>
                      <li><a href="http://nuget.org/packages/Chimayo.Ssis">Get it from NuGet</a></li>
                      <li><a href="http://github.com/chimayo/chimayo">View it on GitHub</a></li>
                  </ul>
              </div>
          </div>
      </nav>
    <div class="container">
        
<h1><a name="Getting-started" class="anchor" href="#Getting-started">Getting started</a></h1>
<p>There are several ways to get started with Chimayo:</p>
<ul>
<li>Use the command line tool to examine or convert packages</li>
<li>Create a new package from scratch using the Chimayo APIs</li>
<li>Reverse engineer an existing package</li>
</ul>
<p>The easiest way to get the Chimayo command line tool and binaries is via <a href="http://nuget.org/packages/Chimayo.Ssis">NuGet</a>.</p>
<p>Currently, Chimayo depends on .NET 4.6.</p>
<h2><a name="Using-the-command-line-tool" class="anchor" href="#Using-the-command-line-tool">Using the command line tool</a></h2>
<p>The command line tool is installed by NuGet into the <code>packages\Chimayo.Ssis.x.y.z\tools</code> folder as <code>Chimayo.Ssis.CommandLine.exe</code>.</p>
<p>If you run the tool without parameters, you get this help info:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="i">Chimayo</span><span class="o">.</span><span class="i">Ssis</span><span class="o">.</span><span class="i">CommandLine</span><span class="o">.</span><span class="i">exe</span> (<span class="i">x</span><span class="o">.</span><span class="i">y</span><span class="o">.</span><span class="i">z</span>)

<span class="i">SQL</span> <span class="i">Server</span> <span class="i">Integration</span> <span class="i">Services</span> <span class="i">package</span> <span class="i">transformations</span>

  <span class="i">Commands</span>

    <span class="o">/</span><span class="i">codegen</span> [<span class="i">inputfile</span>] [<span class="o">/</span><span class="i">o</span> [<span class="i">outputfile</span>]]   <span class="o">-</span> <span class="i">Read</span> <span class="i">an</span> <span class="i">SSIS</span> <span class="i">package</span> <span class="k">and</span> <span class="i">write</span> <span class="i">an</span> <span class="i">F#</span> <span class="i">code</span> <span class="i">file</span>
    <span class="o">/</span><span class="i">roundtrip</span> [<span class="i">inputfile</span>] [<span class="o">/</span><span class="i">o</span> [<span class="i">outputfile</span>]] <span class="o">-</span> <span class="i">Read</span> <span class="i">an</span> <span class="i">SSIS</span> <span class="i">package</span> <span class="k">and</span> <span class="i">write</span> <span class="i">another</span> <span class="i">SSIS</span> <span class="i">package</span>
    <span class="o">/</span><span class="i">roundtripall</span> [<span class="i">path</span>]                     <span class="o">-</span> <span class="i">Read</span> <span class="i">an</span> <span class="i">SSIS</span> <span class="i">package</span> <span class="k">and</span> <span class="i">write</span> <span class="i">another</span> <span class="i">SSIS</span> <span class="i">package</span> <span class="k">for</span> <span class="i">all</span> <span class="i">files</span> <span class="k">in</span> <span class="i">folder</span><span class="o">/</span><span class="i">subtree</span>
    <span class="o">/</span><span class="i">roundtripvalidate</span> [<span class="i">inputfile</span>]           <span class="o">-</span> <span class="i">Validate</span> <span class="i">roundtrip</span>
    <span class="o">/</span><span class="i">validate</span> [<span class="i">inputfile</span>]                    <span class="o">-</span> <span class="i">Validate</span> <span class="i">package</span> <span class="i">design</span>
    <span class="o">/</span><span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">compare</span>                                 <span class="o">-</span> <span class="i">Compare</span> <span class="i">two</span> <span class="i">packages</span>
        [<span class="o">/</span><span class="i">diff</span> <span class="i">N</span>]                              <span class="i">produces</span> <span class="i">a</span> <span class="i">diff</span> <span class="i">style</span> <span class="i">comparison</span> <span class="k">with</span> <span class="i">N</span> <span class="i">context</span> <span class="i">lines</span>
        [<span class="o">/</span><span class="i">iv</span> {<span class="n">2008</span>|<span class="n">2012</span>}] <span class="i">inputfile</span>            <span class="i">version</span> <span class="k">and</span> <span class="i">first</span> <span class="i">input</span> <span class="i">file</span>
        [<span class="o">/</span><span class="i">iv</span> {<span class="n">2008</span>|<span class="n">2012</span>}] <span class="i">inputfile</span>            <span class="i">version</span> <span class="k">and</span> <span class="i">second</span> <span class="i">input</span> <span class="i">file</span>
    <span class="o">/</span><span class="i">version</span>                                 <span class="o">-</span> <span class="i">Show</span> <span class="i">version</span> <span class="i">information</span>
    <span class="o">/?</span> | <span class="o">/</span><span class="i">help</span> | <span class="o">/</span><span class="i">h</span>                          <span class="o">-</span> <span class="i">Show</span> <span class="i">this</span> <span class="i">help</span>

  <span class="i">Options</span>

    <span class="i">inputfile</span>                                <span class="o">-</span> <span class="i">Source</span> <span class="i">filename</span> (<span class="k">default</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">stdin</span>)
    <span class="o">/</span><span class="i">o</span> <span class="i">outputfile</span>                            <span class="o">-</span> <span class="i">Destination</span> <span class="i">filename</span> (<span class="k">default</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">stdout</span>)
    <span class="o">/</span><span class="i">iv</span> {<span class="n">2008</span>|<span class="n">2012</span>}                          <span class="o">-</span> <span class="i">SSIS</span> <span class="i">version</span> <span class="k">for</span> <span class="i">input</span> <span class="i">file</span>
    <span class="o">/</span><span class="i">ov</span> {<span class="n">2008</span>|<span class="n">2012</span>}                          <span class="o">-</span> <span class="i">SSIS</span> <span class="i">version</span> <span class="k">for</span> <span class="i">output</span> <span class="i">file</span> <span class="k">and</span> <span class="k">for</span> <span class="i">roundtrip</span> <span class="i">test</span>
    <span class="o">/</span><span class="i">ns</span> <span class="k">namespace</span>                            <span class="o">-</span> <span class="i">Specify</span> <span class="i">target</span> <span class="k">namespace</span> <span class="k">for</span> <span class="i">generated</span> <span class="i">code</span> (<span class="k">default</span><span class="o">:</span> <span class="i">GeneratedPackages</span>)
    <span class="o">/</span><span class="i">r</span>                                       <span class="o">-</span> <span class="i">Enable</span> <span class="i">recursion</span> <span class="k">in</span> <span class="o">/</span><span class="i">roundtripall</span>
    <span class="o">/</span><span class="i">keep</span>                                    <span class="o">-</span> <span class="i">Keeps</span> <span class="i">original</span> <span class="i">files</span> <span class="k">in</span> <span class="o">/</span><span class="i">roundtripall</span>
</code></pre></td>
</tr>
</table>
<p>Using the <code>/codegen</code> option will let you see the content of a package as F# code. This may help to see how Chimayo is used as well as
showing what a package does.</p>
<p>Using the <code>/compare</code> option will allow you to compare two packages, even between SSIS versions. These are not
XML comparisons, they ignore lots of stuff you don't care about, like the order of information in the package, the
internal GUIDs and diagram data (and lots more) and they hopefully make things much clearer. Chimayo is designed
to have a single internal AST representation for any precise design and to have deterministic code generation.</p>
<h2><a name="Create-a-new-package-from-scratch-using-the-Chimayo-API" class="anchor" href="#Create-a-new-package-from-scratch-using-the-Chimayo-API">Create a new package from scratch using the Chimayo API</a></h2>
<p>There are three steps to this:</p>
<ol>
<li>Create a new .NET 4.6 F# console application project</li>
<li>Add the Chimayo.SSIS NuGet package</li>
<li>Write the package code</li>
</ol>
<p>An example package is shown below:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
<span class="l">38: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span class="i">Chimayo</span><span class="o">.</span><span class="i">Ssis</span><span class="o">.</span><span class="i">Ast</span><span class="o">.</span><span class="i">ControlFlow</span>
<span class="k">open</span> <span class="i">Chimayo</span><span class="o">.</span><span class="i">Ssis</span><span class="o">.</span><span class="i">Ast</span><span class="o">.</span><span class="i">ControlFlowApi</span>
<span class="k">open</span> <span class="i">Chimayo</span><span class="o">.</span><span class="i">Ssis</span><span class="o">.</span><span class="i">Writer2012</span>

<span class="k">let</span> <span class="i">pkg</span> <span class="o">=</span> 
    <span class="i">Package</span><span class="o">.</span><span class="i">create</span> <span class="s">@&quot;My package&quot;</span>
    <span class="o">|&gt;</span> <span class="i">Package</span><span class="o">.</span><span class="i">addVariables</span>
        [
            <span class="i">Variables</span><span class="o">.</span><span class="i">createSimple</span> <span class="s">@&quot;User::myVar&quot;</span> <span class="n">10</span>
            <span class="i">Variables</span><span class="o">.</span><span class="i">createSimple</span> <span class="s">@&quot;User::myVar2&quot;</span> <span class="s">&quot;String variable&quot;</span>
            <span class="i">Variables</span><span class="o">.</span><span class="i">create</span> <span class="s">&quot;CustomNamespace&quot;</span> <span class="s">&quot;exprVar&quot;</span> <span class="k">false</span> <span class="k">false</span> <span class="s">&quot;&quot;</span> (<span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">Some</span> <span class="s">&quot;&quot;&quot; &quot;a&quot; + &quot;b&quot; &quot;&quot;&quot;</span>)
        ]
    <span class="o">|&gt;</span> <span class="i">Package</span><span class="o">.</span><span class="i">addConnectionManagers</span>
        [
            <span class="i">OleDbConnectionManager</span><span class="o">.</span><span class="i">create</span> <span class="s">&quot;SQL&quot;</span>
                <span class="o">&lt;|</span> <span class="i">SqlConnectionStringHelper</span><span class="o">.</span><span class="i">createInlineOleDbConnectionString</span> <span class="s">&quot;.&quot;</span> <span class="s">&quot;tempdb&quot;</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="i">None</span> <span class="s">&quot;Chimayo SSIS Example&quot;</span>
        ]
    <span class="o">|&gt;</span> <span class="i">Package</span><span class="o">.</span><span class="i">addExecutables</span>
        [
            <span class="k">let</span> <span class="i">exes</span> <span class="o">=</span>
                [
                    <span class="i">ExecuteSql</span><span class="o">.</span><span class="i">createSimple</span> <span class="s">&quot;SQL1&quot;</span> <span class="s">&quot;SQL&quot;</span> <span class="s">&quot;PRINT &#39;HELLO&#39;&quot;</span>
                    <span class="i">ExecuteSql</span><span class="o">.</span><span class="i">createSimple</span> <span class="s">&quot;SQL2&quot;</span> <span class="s">&quot;SQL&quot;</span> <span class="s">&quot;PRINT &#39;WORLD&#39;&quot;</span>
                    <span class="i">ExecuteSql</span><span class="o">.</span><span class="i">createSimple</span> <span class="s">&quot;SQL3&quot;</span> <span class="s">&quot;SQL&quot;</span> <span class="s">&quot;PRINT &#39;FROM&#39;&quot;</span>
                    <span class="i">ExecuteSql</span><span class="o">.</span><span class="i">createSimple</span> <span class="s">&quot;SQL4&quot;</span> <span class="s">&quot;SQL&quot;</span> <span class="s">&quot;PRINT &#39;CHIMAYO&#39;&quot;</span>
                ]
            <span class="k">let</span> <span class="i">final</span>, <span class="i">priors</span> <span class="o">=</span> <span class="i">exes</span> <span class="o">|&gt;</span> <span class="i">PrecedenceConstraints</span><span class="o">.</span><span class="i">chain</span> <span class="i">CfExecutableResult</span><span class="o">.</span><span class="i">Success</span>
            <span class="k">yield!</span> <span class="i">priors</span>
            <span class="k">yield</span> <span class="i">final</span>
        ]

[&lt;<span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="i">EntryPoint</span>&gt;]
<span class="k">let</span> <span class="i">main</span> <span class="i">argv</span> <span class="o">=</span> 
    <span class="i">pkg</span>
    <span class="o">|&gt;</span> <span class="i">Chimayo</span><span class="o">.</span><span class="i">Ssis</span><span class="o">.</span><span class="i">Writer2012</span><span class="o">.</span><span class="i">PackageBuilder</span><span class="o">.</span><span class="i">toString</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7)" class="i">printf</span> <span class="s">&quot;%s\n&quot;</span> 
    <span onmouseout="hideTip(event, 'fs8', 8)" onmouseover="showTip(event, 'fs8', 8)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs9', 9)" onmouseover="showTip(event, 'fs9', 9)" class="i">Console</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 10)" onmouseover="showTip(event, 'fs10', 10)" class="i">ReadLine</span>() <span class="o">|&gt;</span><span onmouseout="hideTip(event, 'fs11', 11)" onmouseover="showTip(event, 'fs11', 11)" class="i">ignore</span>
    <span class="n">0</span>
</code></pre></td>
</tr>
</table>
<p>As with most F# programs, it is easiest to read this bottom-up.</p>
<h3><a name="main" class="anchor" href="#main">main</a></h3>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp">[&lt;<span onmouseout="hideTip(event, 'fs6', 12)" onmouseover="showTip(event, 'fs6', 12)" class="i">EntryPoint</span>&gt;]
<span class="k">let</span> <span class="i">main</span> <span class="i">argv</span> <span class="o">=</span> 
    <span class="i">pkg</span>
    <span class="o">|&gt;</span> <span class="i">Chimayo</span><span class="o">.</span><span class="i">Ssis</span><span class="o">.</span><span class="i">Writer2012</span><span class="o">.</span><span class="i">PackageBuilder</span><span class="o">.</span><span class="i">toString</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs7', 13)" onmouseover="showTip(event, 'fs7', 13)" class="i">printf</span> <span class="s">&quot;%s\n&quot;</span> 
    <span onmouseout="hideTip(event, 'fs8', 14)" onmouseover="showTip(event, 'fs8', 14)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs9', 15)" onmouseover="showTip(event, 'fs9', 15)" class="i">Console</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 16)" onmouseover="showTip(event, 'fs10', 16)" class="i">ReadLine</span>() <span class="o">|&gt;</span><span onmouseout="hideTip(event, 'fs11', 17)" onmouseover="showTip(event, 'fs11', 17)" class="i">ignore</span>
    <span class="n">0</span>
</code></pre></td>
</tr>
</table>
<p>This takes an existing value, <code>pkg</code>, and passes it to one of the SSIS 2012 Writer functions. There
are several functions available and this one directly dumps the SSIS XML to the console. Because
the .NET String type has utf-16 type internally, you can see the XML encoding is also utf-16. In
general, packages are directly written to disk as utf-8.</p>
<p>It then waits for input before exiting, because otherwise the window will close when run from Visual Studio!</p>
<h3><a name="let-pkg" class="anchor" href="#let-pkg">let pkg</a></h3>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span class="i">pkg</span> <span class="o">=</span> 
    <span class="i">Package</span><span class="o">.</span><span class="i">create</span> <span class="s">@&quot;My package&quot;</span>
    <span class="o">|&gt;</span> <span class="i">Package</span><span class="o">.</span><span class="i">addVariables</span> <span class="o">..</span><span class="o">.</span>
    <span class="o">|&gt;</span> <span class="i">Package</span><span class="o">.</span><span class="i">addConnectionManagers</span> <span class="o">..</span><span class="o">.</span>
    <span class="o">|&gt;</span> <span class="i">Package</span><span class="o">.</span><span class="i">addExecutables</span> <span class="o">..</span><span class="o">.</span>
</code></pre></td>
</tr>
</table>
<p>Chimayo is designed for a normal functional programming experience. <code>Package.create</code> creates
a new instance of the <code>CftPackage</code> type that represents a single complete SSIS package. This
is a record type that has a number of properties and deeply nested collections to represent
the hierarchy of control flow tasks and any data flows (also called pipelines) that are defined.</p>
<p>Each of the functions here adds detail to one or more fields in the type. Each of these
fields are collections and are generally added to using lists, although in many cases
you can add one at a time using other functions in the module.</p>
<p>This code also demonstrates the general pattern in Chimayo, data types are prefixed
with one of <code>Cf</code>, <code>Cft</code> or <code>Df</code> for Control Flow, Control Flow Task or Data Flow
respectively. In SSIS terminology, a package is a kind of SSIS task, so that's why
it also has a <code>Cft</code> prefix. APIs do not have the prefix, but are otherwise similarly
named.</p>
<p>APIs are in the <code>Ast.ControlFlowApi</code> and <code>Ast.DataFlowApi</code> namespaces, and data
types are in the <code>Ast.ControlFlow</code> and <code>Ast.DataFlow</code> namespaces.</p>
<ul>
<li>See <a href="reference/chimayo-ssis-ast-controlflow-cftpackage.html">CftPackage</a></li>
<li>See <a href="reference/chimayo-ssis-ast-controlflowapi-package.html">Package</a></li>
</ul>
<h3><a name="Variables" class="anchor" href="#Variables">Variables</a></h3>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp">            <span class="i">Variables</span><span class="o">.</span><span class="i">createSimple</span> <span class="s">@&quot;User::myVar&quot;</span> <span class="n">10</span>
            <span class="i">Variables</span><span class="o">.</span><span class="i">createSimple</span> <span class="s">@&quot;User::myVar2&quot;</span> <span class="s">&quot;String variable&quot;</span>
            <span class="i">Variables</span><span class="o">.</span><span class="i">create</span> <span class="s">&quot;CustomNamespace&quot;</span> <span class="s">&quot;exprVar&quot;</span> <span class="k">false</span> <span class="k">false</span> <span class="s">&quot;&quot;</span> (<span onmouseout="hideTip(event, 'fs4', 18)" onmouseover="showTip(event, 'fs4', 18)" class="i">Some</span> <span class="s">&quot;&quot;&quot; &quot;a&quot; + &quot;b&quot; &quot;&quot;&quot;</span>)
</code></pre></td>
</tr>
</table>
<p>Variables, and other types, are typically created using helper methods in similarly
named modules in the ...Api namespaces, although you can create them directly using
the record type definitions if you prefer. The APIs are more resilient to change
in the data type design, but the data types are designed to be open and correlate to
the SSIS internal specifications for each type of object, to the extent that support
is implemented.</p>
<p>These three statements each create a single SSIS variable at the top level in the package.
Variables can also be added at task level, exactly the same as if you were creating
the package in the graphical designer.</p>
<p>The variables are:</p>
<ul>
<li>An integer variable in the namespace <em>User</em> and named <em>myVar</em> with the value 10</li>
<li>A string variable in the namespace <em>User</em> and named <em>myVar2</em> with the value "String variable"</li>
<li>
A string variable in the namespace <em>CustomNamespace</em> and named <em>exprVar</em> which has the expresssion <code>"a" + "b"</code>
and the initial value "" (which is immediately overwritten by the expression). The other two options
are the defaults for <em>read only</em> and <em>raise change events</em>
</li>
</ul>
<h3><a name="Connection-Managers" class="anchor" href="#Connection-Managers">Connection Managers</a></h3>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp">            <span class="i">OleDbConnectionManager</span><span class="o">.</span><span class="i">create</span> <span class="s">&quot;SQL&quot;</span>
                <span class="o">&lt;|</span> <span class="i">SqlConnectionStringHelper</span><span class="o">.</span><span class="i">createInlineOleDbConnectionString</span> <span class="s">&quot;.&quot;</span> <span class="s">&quot;tempdb&quot;</span> <span onmouseout="hideTip(event, 'fs5', 19)" onmouseover="showTip(event, 'fs5', 19)" class="i">None</span> <span class="s">&quot;Chimayo SSIS Example&quot;</span>
</code></pre></td>
</tr>
</table>
<p>This code adds an OleDB connection manager named <em>SQL</em> to the package. Connection strings
can be manually defined, but in this case it is constructed via a helper function.</p>
<p>Currently, the code has support for creating SQL Server 2012 Native Client connections. You will need
to override the provider name if you want to use a different native client version.</p>
<p>This particular connection manager:</p>
<ul>
<li>Is named "SQL"</li>
<li>Connects to the local server, "."</li>
<li>Connects to the "tempdb" database</li>
<li>Uses integrated security (the <code>None</code> option, can also be <code>Some</code> username and password tuple)</li>
</ul>
<h3><a name="Tasks" class="anchor" href="#Tasks">Tasks</a></h3>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp">            <span class="k">let</span> <span class="i">exes</span> <span class="o">=</span>
                [
                    <span class="i">ExecuteSql</span><span class="o">.</span><span class="i">createSimple</span> <span class="s">&quot;SQL1&quot;</span> <span class="s">&quot;SQL&quot;</span> <span class="s">&quot;PRINT &#39;HELLO&#39;&quot;</span>
                    <span class="i">ExecuteSql</span><span class="o">.</span><span class="i">createSimple</span> <span class="s">&quot;SQL2&quot;</span> <span class="s">&quot;SQL&quot;</span> <span class="s">&quot;PRINT &#39;WORLD&#39;&quot;</span>
                    <span class="i">ExecuteSql</span><span class="o">.</span><span class="i">createSimple</span> <span class="s">&quot;SQL3&quot;</span> <span class="s">&quot;SQL&quot;</span> <span class="s">&quot;PRINT &#39;FROM&#39;&quot;</span>
                    <span class="i">ExecuteSql</span><span class="o">.</span><span class="i">createSimple</span> <span class="s">&quot;SQL4&quot;</span> <span class="s">&quot;SQL&quot;</span> <span class="s">&quot;PRINT &#39;CHIMAYO&#39;&quot;</span>
                ]
            <span class="k">let</span> <span class="i">final</span>, <span class="i">priors</span> <span class="o">=</span> <span class="i">exes</span> <span class="o">|&gt;</span> <span class="i">PrecedenceConstraints</span><span class="o">.</span><span class="i">chain</span> <span class="i">CfExecutableResult</span><span class="o">.</span><span class="i">Success</span>
            <span class="k">yield!</span> <span class="i">priors</span>
            <span class="k">yield</span> <span class="i">final</span>
</code></pre></td>
</tr>
</table>
<p>Tasks, or executables, are control flow elements. This code works as follows:</p>
<ul>
<li>Lines 1 to 7 create four new ExecuteSQL tasks in a value <code>exes</code></li>
<li>
Line 8 creates an ordered sequence of precedence constraints between the four
tasks. It associates the updated tasks with two values, the first three tasks
as <code>priors</code> and the final one as <code>final</code>. The difference here is because
you typically want to attach further precedence constraints to the final
task in the chain
</li>
<li>Lines 9 and 10 expose the four adapted tasks to be added to the package</li>
</ul>
<p>There are many different types of executable but they can be added in the same way.
Similarly, precedence constraints can be added in a few ways and there is full support
for the variety of precedence constraints supported by SSIS.</p>
<h2><a name="Reveres-engineer-an-existing-package" class="anchor" href="#Reveres-engineer-an-existing-package">Reveres engineer an existing package</a></h2>
<p>So long as you have an existing SSIS 2008 R2 or SSIS 2012 package that conforms with
the feature set supported by Chimayo, you can reverse engineer it into F# code, and
then you can also inspect the CftPackage instance that's created.</p>
<p>Just use the command line tool as explained above, for example:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="i">Chimayo</span><span class="o">.</span><span class="i">Ssis</span><span class="o">.</span><span class="i">CommandLine</span><span class="o">.</span><span class="i">exe</span> <span class="o">/</span><span class="i">codegen</span> <span class="o">/</span><span class="i">iv</span> <span class="n">2008</span> <span class="i">MySsis2008Package</span><span class="o">.</span><span class="i">dtsx</span> <span class="o">/</span><span class="i">o</span> <span class="i">MySsis2008Package</span><span class="o">.</span><span class="i">fs</span>
<span class="i">Chimayo</span><span class="o">.</span><span class="i">Ssis</span><span class="o">.</span><span class="i">CommandLine</span><span class="o">.</span><span class="i">exe</span> <span class="o">/</span><span class="i">codegen</span> <span class="o">/</span><span class="i">iv</span> <span class="n">2012</span> <span class="i">MySsis2012Package</span><span class="o">.</span><span class="i">dtsx</span> <span class="o">/</span><span class="i">o</span> <span class="i">MySsis2012Package</span><span class="o">.</span><span class="i">fs</span>
</code></pre></td>
</tr>
</table>

<div class="tip" id="fs1">val compare : e1:&#39;T -&gt; e2:&#39;T -&gt; int (requires comparison)<br /><br />Full name: Microsoft.FSharp.Core.Operators.compare</div>
<div class="tip" id="fs2">val stdin&lt;&#39;T&gt; : System.IO.TextReader<br /><br />Full name: Microsoft.FSharp.Core.Operators.stdin</div>
<div class="tip" id="fs3">val stdout&lt;&#39;T&gt; : System.IO.TextWriter<br /><br />Full name: Microsoft.FSharp.Core.Operators.stdout</div>
<div class="tip" id="fs4">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs5">union case Option.None: Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs6">Multiple items<br />type EntryPointAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; EntryPointAttribute<br /><br />Full name: Microsoft.FSharp.Core.EntryPointAttribute<br /><br />--------------------<br />new : unit -&gt; EntryPointAttribute</div>
<div class="tip" id="fs7">val printf : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printf</div>
<div class="tip" id="fs8">namespace System</div>
<div class="tip" id="fs9">type Console =<br />&#160;&#160;static member BackgroundColor : ConsoleColor with get, set<br />&#160;&#160;static member Beep : unit -&gt; unit + 1 overload<br />&#160;&#160;static member BufferHeight : int with get, set<br />&#160;&#160;static member BufferWidth : int with get, set<br />&#160;&#160;static member CapsLock : bool<br />&#160;&#160;static member Clear : unit -&gt; unit<br />&#160;&#160;static member CursorLeft : int with get, set<br />&#160;&#160;static member CursorSize : int with get, set<br />&#160;&#160;static member CursorTop : int with get, set<br />&#160;&#160;static member CursorVisible : bool with get, set<br />&#160;&#160;...<br /><br />Full name: System.Console</div>
<div class="tip" id="fs10">System.Console.ReadLine() : string</div>
<div class="tip" id="fs11">val ignore : value:&#39;T -&gt; unit<br /><br />Full name: Microsoft.FSharp.Core.Operators.ignore</div>

    </div>
    <script type="text/javascript" src="/chimayo/content/tips.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery-ui.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  </body>
  </html>
